# BiasDF
Official implementation of the paper 'Bias Analysis for Synthetic Face Detection: A Case Study of the Impact of Facial Attributes'
===========================================
🧠 Facial Attribute Generator + Image Creator
===========================================

This project includes two Python scripts:

1. `generate_input_description.py`  
   ➤ Generates a CSV file containing all combinations of facial attributes, one-hot encoded features, and natural-language descriptions.

2. `generate_images.py`  
   ➤ Uses Stable Diffusion to generate 4 images per description from the CSV file.

-------------------------------------------
📦 Requirements
-------------------------------------------

- Python 3.8 or higher

Install the required packages:

    pip install pandas torch diffusers transformers pillow

-------------------------------------------
📁 File Structure
-------------------------------------------

- generate_input_description.py : Generates data and descriptions  
- generate_images.py            : Generates images using Stable Diffusion  
- df_input_description.csv      : Output CSV file (generated by script 1)  
- images_diff/                  : Folder where images will be saved (by script 2)

=================================================
📄 Script 1: generate_input_description.py
=================================================

This script creates:

- All possible attribute combinations
- One-hot encoded binary vectors
- A readable natural-language description for each combination

Each row in the output CSV contains a combination like:

    no attractive woman and old and gray hair and wavy hair and white skin and green eyes and Mustach and heavy makeup and pointy nose and square face

----------------------------------
🔧 How to Use Script 1 (Step by Step)
----------------------------------

1️⃣ Open a terminal or command prompt  
2️⃣ Make sure you're in the folder where the script is saved  
3️⃣ Run the script using:

    python generate_input_description.py --output ./df_input_description.csv

✔️ This will generate a file named `df_input_description.csv` in your current directory.

📌 To customize the attributes (e.g., add “emotion”), modify the `attributes` dictionary at the top of the script.

Example:

    "Emotion": ["happy", "sad", "angry"]

=================================================
🖼️ Script 2: generate_images.py
=================================================

This script reads the `df_input_description.csv` file and generates 4 images per row using the Stable Diffusion model `runwayml/stable-diffusion-v1-5`.

Each image is generated from the corresponding `description` column in the CSV.

The generated images are saved in the folder you specify (default: `images_diff`).

----------------------------------
🖥️ How to Use Script 2 (Step by Step)
----------------------------------

1️⃣ Make sure you've already generated `df_input_description.csv` using Script 1  
2️⃣ Open a terminal  
3️⃣ Run the script using:

    python generate_images.py --input ./df_input_description.csv --output ./images_diff

✔️ This will read your CSV file and save images like:

    img_diff_0_1.png  
    img_diff_0_2.png  
    img_diff_0_3.png  
    img_diff_0_4.png  
    ...
    img_diff_1_1.png  
    ...

📂 All images will be saved in the folder `images_diff` (or any folder you choose using `--output`).

✅ GPU will be used automatically if available. Otherwise, it runs on CPU (but slower).

=================================================
📬 Contact
=================================================

For questions, issues, or contributions, feel free to reach out to the author or open an issue on GitHub.
